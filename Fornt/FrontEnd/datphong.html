<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω ƒê·∫∑t Ph√≤ng - Kh√°ch S·∫°n</title>
    <link rel="stylesheet" href="style.css">

    
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">üìÖ</div>
                <h1>Qu·∫£n L√Ω ƒê·∫∑t Ph√≤ng</h1>
            </div>
        </header>

        <nav>
            <ul class="nav-menu">
                <li><a href="index.html">üìä T·ªïng Quan</a></li>
                <li><a href="phong.html">üè† Qu·∫£n L√Ω Ph√≤ng</a></li>
                <li><a href="datphong.html" class="active">üìÖ ƒê·∫∑t Ph√≤ng</a></li>
                <li><a href="khachhang.html">üë• Kh√°ch H√†ng</a></li>
                <li><a href="hoadon.html">üí∞ H√≥a ƒê∆°n</a></li>
                <li><a href="dichvu.html">üõéÔ∏è D·ªãch V·ª•</a></li>
                <li><a href="baocao.html">üìà B√°o C√°o</a></li>
            </ul>
        </nav>

        <div class="content">
            <div class="toolbar">
                <div class="search-bar">
                    <input type="text" id="searchBooking" placeholder="üîç T√¨m ki·∫øm theo t√™n kh√°ch...">
                    <input type="date" id="filterDateFrom">
                    <input type="date" id="filterDateTo">
                    <select id="filterStatus">
                        <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                        <option value="DaDat">ƒê√£ ƒê·∫∑t</option>
                        <option value="DaNhan">ƒê√£ Nh·∫≠n</option>
                        <option value="DaTra">ƒê√£ Tr·∫£</option>
                        <option value="Huy">H·ªßy</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="openAddModal()">+ ƒê·∫∑t Ph√≤ng M·ªõi</button>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>M√£ ƒê·∫∑t</th>
                        <th>Kh√°ch H√†ng</th>
                        <th>Lo·∫°i Ph√≤ng</th>
                        <th>S·ªë Ph√≤ng</th>
                        <th>Ng√†y Nh·∫≠n</th>
                        <th>Ng√†y Tr·∫£</th>
                        <th>S·ªë Kh√°ch</th>
                        <th>Tr·∫°ng Th√°i</th>
                        <th>Thao T√°c</th>
                    </tr>
                </thead>
                <tbody id="bookingList">
                    <!-- Data will be loaded here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal Th√™m/S·ª≠a ƒê·∫∑t Ph√≤ng -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ƒê·∫∑t Ph√≤ng M·ªõi</h2>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <form id="bookingForm">
                <div class="form-group">
                    <label>M√£ ƒê·∫∑t Ph√≤ng <span class="required">*</span></label>
                    <input type="text" id="bookingCode" required placeholder="VD: DP001">
                </div>

                <div class="form-group">
                    <label>Kh√°ch H√†ng <span class="required">*</span></label>
                    <select id="customerId" required>
                        <option value="">-- Ch·ªçn kh√°ch h√†ng --</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Lo·∫°i Ph√≤ng <span class="required">*</span></label>
                        <select id="roomType" required onchange="loadAvailableRooms()">
                            <option value="">-- Ch·ªçn lo·∫°i ph√≤ng --</option>
                            <option value="STD">Standard</option>
                            <option value="SUP">Superior</option>
                            <option value="DEL">Deluxe</option>
                            <option value="JR-SUI">Junior Suite</option>
                            <option value="EXE-SUI">Executive Suite</option>
                            <option value="FAM">Family Room</option>
                            <option value="PRES">Presidential Suite</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>S·ªë Ph√≤ng</label>
                        <select id="roomNumber">
                            <option value="">-- Ch·ªçn ph√≤ng c·ª• th·ªÉ (t√πy ch·ªçn) --</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y Nh·∫≠n <span class="required">*</span></label>
                        <input type="datetime-local" id="checkIn" required>
                    </div>

                    <div class="form-group">
                        <label>Ng√†y Tr·∫£ <span class="required">*</span></label>
                        <input type="datetime-local" id="checkOut" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë Kh√°ch <span class="required">*</span></label>
                        <input type="number" id="guestCount" required min="1" value="1">
                    </div>

                    <div class="form-group">
                        <label>Tr·∫°ng Th√°i <span class="required">*</span></label>
                        <select id="bookingStatus" required>
                            <option value="DaDat">ƒê√£ ƒê·∫∑t</option>
                            <option value="DaNhan">ƒê√£ Nh·∫≠n</option>
                            <option value="DaTra">ƒê√£ Tr·∫£</option>
                            <option value="Huy">H·ªßy</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ghi Ch√∫</label>
                    <textarea id="note" rows="3" placeholder="Ghi ch√∫ ƒë·∫∑t ph√≤ng..."></textarea>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 25px;">
                    <button type="submit" class="btn btn-primary">üíæ L∆∞u</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">‚úñ H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu m·∫´u
        const customers = [
            { id: 1, name: 'Phan VƒÉn Kh√°nh', phone: '0901234567' },
            { id: 2, name: 'V≈© Minh H√†o', phone: '0902345678' },
            { id: 3, name: 'L∆∞u Th·ªã Thanh Mai', phone: '0903456789' },
            { id: 4, name: 'L√™ Ti·∫øn Linh', phone: '0904567890' },
            { id: 5, name: 'Ph·∫°m Huy Anh', phone: '0905678901' },
            { id: 6, name: 'Nguy·ªÖn VƒÉn Ph√∫c', phone: '0906789012' },
            { id: 7, name: 'L√™ Huy Ho√†ng', phone: '0907890123' },
            { id: 8, name: 'ƒêinh Ng·ªçc ƒê·∫°i', phone: '0908901234' },
            { id: 9, name: 'Ng√¥ Minh Nguy·ªát', phone: '0909012345' },
            { id: 10, name: 'Nguy·ªÖn VƒÉn D≈©ng', phone: '0910123456' }
        ];

        const roomTypes = {
            'STD': 'Standard',
            'SUP': 'Superior',
            'DEL': 'Deluxe',
            'JR-SUI': 'Junior Suite',
            'EXE-SUI': 'Executive Suite',
            'FAM': 'Family Room',
            'PRES': 'Presidential Suite'
        };

        const availableRooms = {
            'STD': ['101', '102', '104', '105', '106', '108', '109', '110'],
            'SUP': ['201', '202', '203', '205', '206', '207', '209', '210'],
            'DEL': ['301', '302', '303', '304', '306', '307', '308', '309', '310'],
            'JR-SUI': ['401', '402', '404', '405'],
            'EXE-SUI': ['501', '503', '505'],
            'FAM': ['601', '602', '603', '605'],
            'PRES': ['701', '702']
        };

        let bookings = [
            { id: 30, code: 'DP030', customerId: 10, customerName: 'D∆∞∆°ng M·ªãch', roomType: 'FAM', roomNumber: '603', checkIn: '2024-10-06T14:00', checkOut: '2024-10-08T11:00', guests: 6, status: 'DaDat', note: 'Large family' },
            { id: 29, code: 'DP029', customerId: 9, customerName: 'Giang Th·ªã Hu·ªá', roomType: 'JR-SUI', roomNumber: '405', checkIn: '2024-10-05T15:00', checkOut: '2024-10-07T12:00', guests: 4, status: 'DaDat', note: 'Premium experience' },
            { id: 28, code: 'DP028', customerId: 8, customerName: 'Nguy·ªÖn H√† Thu', roomType: 'DEL', roomNumber: '306', checkIn: '2024-10-04T16:00', checkOut: '2024-10-06T11:00', guests: 3, status: 'DaDat', note: 'Extended stay' },
            { id: 18, code: 'DP018', customerId: 6, customerName: 'Nguy·ªÖn Th·ªã H√≤a', roomType: 'JR-SUI', roomNumber: '403', checkIn: '2024-09-23T16:00', checkOut: '2024-09-25T11:00', guests: 4, status: 'DaNhan', note: 'Currently staying' },
            { id: 17, code: 'DP017', customerId: 5, customerName: 'Tr·∫ßn Th·∫ø Thi√™n', roomType: 'DEL', roomNumber: '303', checkIn: '2024-09-22T14:00', checkOut: '2024-09-24T12:00', guests: 3, status: 'DaTra', note: 'Mini vacation' },
            { id: 16, code: 'DP016', customerId: 4, customerName: 'Nguy·ªÖn M·∫°nh D≈©ng', roomType: 'SUP', roomNumber: '203', checkIn: '2024-09-21T15:00', checkOut: '2024-09-23T11:00', guests: 2, status: 'DaTra', note: 'Romantic trip' },
            { id: 15, code: 'DP015', customerId: 3, customerName: 'B√πi Tr√≠ D≈©ng', roomType: 'STD', roomNumber: '103', checkIn: '2024-09-20T14:00', checkOut: '2024-09-22T12:00', guests: 2, status: 'DaTra', note: 'Weekend getaway' }
        ];

        let currentBookingId = null;

        function loadCustomerOptions() {
            const select = document.getElementById('customerId');
            select.innerHTML = '<option value="">-- Ch·ªçn kh√°ch h√†ng --</option>';
            customers.forEach(c => {
                select.innerHTML += `<option value="${c.id}">${c.name} - ${c.phone}</option>`;
            });
        }

        function loadAvailableRooms() {
            const roomType = document.getElementById('roomType').value;
            const select = document.getElementById('roomNumber');
            select.innerHTML = '<option value="">-- Ch·ªçn ph√≤ng c·ª• th·ªÉ (t√πy ch·ªçn) --</option>';
            
            if (roomType && availableRooms[roomType]) {
                availableRooms[roomType].forEach(room => {
                    select.innerHTML += `<option value="${room}">${room}</option>`;
                });
            }
        }

        function loadBookings() {
            const tbody = document.getElementById('bookingList');
            const searchTerm = document.getElementById('searchBooking').value.toLowerCase();
            const filterStatus = document.getElementById('filterStatus').value;
            const filterDateFrom = document.getElementById('filterDateFrom').value;
            const filterDateTo = document.getElementById('filterDateTo').value;

            let filteredBookings = bookings.filter(b => {
                const matchSearch = b.customerName.toLowerCase().includes(searchTerm);
                const matchStatus = !filterStatus || b.status === filterStatus;
                const matchDateFrom = !filterDateFrom || b.checkIn >= filterDateFrom;
                const matchDateTo = !filterDateTo || b.checkOut <= filterDateTo + 'T23:59';
                return matchSearch && matchStatus && matchDateFrom && matchDateTo;
            });

            tbody.innerHTML = '';
            filteredBookings.forEach(b => {
                const statusClass = b.status === 'DaDat' ? 'info' : 
                                   b.status === 'DaNhan' ? 'success' : 
                                   b.status === 'DaTra' ? 'warning' : 'danger';
                const statusText = b.status === 'DaDat' ? 'ƒê√£ ƒê·∫∑t' : 
                                  b.status === 'DaNhan' ? 'ƒê√£ Nh·∫≠n' : 
                                  b.status === 'DaTra' ? 'ƒê√£ Tr·∫£' : 'H·ªßy';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${b.code}</strong></td>
                    <td>${b.customerName}</td>
                    <td>${roomTypes[b.roomType]}</td>
                    <td>${b.roomNumber}</td>
                    <td>${formatDateTime(b.checkIn)}</td>
                    <td>${formatDateTime(b.checkOut)}</td>
                    <td>${b.guests}</td>
                    <td><span class="badge badge-${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="btn btn-success" onclick="viewBooking(${b.id})" style="padding: 6px 12px; font-size: 12px;">üëÅÔ∏è Xem</button>
                        <button class="btn btn-danger" onclick="deleteBooking(${b.id})" style="padding: 6px 12px; font-size: 12px;">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function formatDateTime(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleString('vi-VN', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function openAddModal() {
            document.getElementById('modalTitle').textContent = 'ƒê·∫∑t Ph√≤ng M·ªõi';
            document.getElementById('bookingForm').reset();
            currentBookingId = null;
            document.getElementById('bookingModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('bookingModal').classList.remove('active');
        }

        function viewBooking(id) {
            const booking = bookings.find(b => b.id === id);
            if (!booking) return;

            currentBookingId = id;
            document.getElementById('modalTitle').textContent = 'S·ª≠a ƒê·∫∑t Ph√≤ng - ' + booking.code;
            document.getElementById('bookingCode').value = booking.code;
            document.getElementById('customerId').value = booking.customerId;
            document.getElementById('roomType').value = booking.roomType;
            loadAvailableRooms();
            document.getElementById('roomNumber').value = booking.roomNumber;
            document.getElementById('checkIn').value = booking.checkIn;
            document.getElementById('checkOut').value = booking.checkOut;
            document.getElementById('guestCount').value = booking.guests;
            document.getElementById('bookingStatus').value = booking.status;
            document.getElementById('note').value = booking.note || '';
            document.getElementById('bookingModal').classList.add('active');
        }

        function deleteBooking(id) {
            if (!confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë·∫∑t ph√≤ng n√†y?')) return;
            bookings = bookings.filter(b => b.id !== id);
            loadBookings();
            alert('‚úÖ ƒê√£ x√≥a ƒë·∫∑t ph√≤ng th√†nh c√¥ng!');
        }

        document.getElementById('bookingForm').onsubmit = function(e) {
            e.preventDefault();

            const code = document.getElementById('bookingCode').value;
            const customerId = parseInt(document.getElementById('customerId').value);
            const customer = customers.find(c => c.id === customerId);
            const roomType = document.getElementById('roomType').value;
            const roomNumber = document.getElementById('roomNumber').value;
            const checkIn = document.getElementById('checkIn').value;
            const checkOut = document.getElementById('checkOut').value;
            const guests = parseInt(document.getElementById('guestCount').value);
            const status = document.getElementById('bookingStatus').value;
            const note = document.getElementById('note').value;

            if (currentBookingId) {
                // S·ª≠a
                const booking = bookings.find(b => b.id === currentBookingId);
                if (booking) {
                    booking.code = code;
                    booking.customerId = customerId;
                    booking.customerName = customer.name;
                    booking.roomType = roomType;
                    booking.roomNumber = roomNumber;
                    booking.checkIn = checkIn;
                    booking.checkOut = checkOut;
                    booking.guests = guests;
                    booking.status = status;
                    booking.note = note;
                    alert('‚úÖ C·∫≠p nh·∫≠t ƒë·∫∑t ph√≤ng th√†nh c√¥ng!');
                }
            } else {
                // Th√™m m·ªõi
                const newBooking = {
                    id: Math.max(...bookings.map(b => b.id)) + 1,
                    code: code,
                    customerId: customerId,
                    customerName: customer.name,
                    roomType: roomType,
                    roomNumber: roomNumber,
                    checkIn: checkIn,
                    checkOut: checkOut,
                    guests: guests,
                    status: status,
                    note: note
                };
                bookings.unshift(newBooking);
                alert('‚úÖ ƒê·∫∑t ph√≤ng m·ªõi th√†nh c√¥ng!');
            }

            closeModal();
            loadBookings();
        };

        // Event listeners
        document.getElementById('searchBooking').addEventListener('input', loadBookings);
        document.getElementById('filterStatus').addEventListener('change', loadBookings);
        document.getElementById('filterDateFrom').addEventListener('change', loadBookings);
        document.getElementById('filterDateTo').addEventListener('change', loadBookings);

        // Initialize
        loadCustomerOptions();
        loadBookings();
    </script>
</body>
</html>